ğŸ§  Sustainet Inc. - æ°¸çºŒè³‡è¨Šå°æŠ—æ¨¡æ“¬å™¨

Sustainet Inc. æ˜¯ä¸€æ¬¾ä»¥æ°¸çºŒè­°é¡Œç‚ºä¸»é¡Œçš„ç­–ç•¥æ¨¡æ“¬éŠæˆ²ï¼Œæ¢ç´¢å‡è¨Šæ¯å¦‚ä½•å½±éŸ¿äººå€‘å°æ°£å€™ã€èƒ½æºèˆ‡ç¤¾æœƒæ­£ç¾©ç­‰æ°¸çºŒè­°é¡Œçš„èªçŸ¥ã€‚ç©å®¶å°‡æ‰®æ¼”è³‡è¨Šå®ˆé–€äººè§’è‰²ï¼Œå–„ç”¨æŸ¥æ ¸å·¥å…·èˆ‡ç¤¾ç¾¤è§€å¯ŸåŠ›ï¼Œèˆ‡ AI å‡è¨Šæ¯æ“ç¸±è€…å°æŠ—ï¼Œåœ¨å‹•æ…‹ç¤¾ç¾¤ç’°å¢ƒä¸­ç¶­æŒå…¬çœ¾ä¿¡ä»»èˆ‡è³‡è¨Šé€æ˜åº¦ã€‚

ğŸ“¦ æŠ€è¡“æ¶æ§‹ç¸½è¦½

æœ¬å°ˆæ¡ˆæ¡ç”¨ Clean Architectureï¼Œä¸¦çµåˆ Agno ä½œç‚º Agent ç®¡ç†æ¡†æ¶ã€‚
```
API (FastAPI)
â””â”€â”€ Application Layer (Use Cases, DTOs)
    â””â”€â”€ Domain Layer (Entities, Logic)
        â””â”€â”€ Infrastructure Layer (å¤–éƒ¨ä¾è³´)
```

ğŸ“ å°ˆæ¡ˆç›®éŒ„çµæ§‹

```
src/
â”œâ”€â”€ api/                        # FastAPI endpoints
â”‚   â”œâ”€â”€ routes/                 # æ‰€æœ‰è·¯ç”±
â”‚   â””â”€â”€ middleware/             # ä¸­é–“ä»¶ (éŒ¯èª¤è™•ç†ç­‰)
â”œâ”€â”€ application/                # Use Caseã€DTO
â”‚   â”œâ”€â”€ services/               # éŠæˆ²æœå‹™é‚è¼¯ï¼ˆä½¿ç”¨å·¥å…·ã€æäº¤è¡Œå‹•ç­‰ï¼‰
â”‚   â””â”€â”€ dto/                    # Pydantic è¼¸å…¥ / è¼¸å‡ºæ¨¡å‹
â”œâ”€â”€ domain/                     # æ ¸å¿ƒæ¥­å‹™é‚è¼¯
â”‚   â”œâ”€â”€ models/                 # Entity / ValueObject
â”‚   â””â”€â”€ logic/                  # è¦å‰‡è¨ˆç®—å™¨ã€å¾—åˆ†é‚è¼¯ã€å·¥å…·å½±éŸ¿
â”œâ”€â”€ infrastructure/             # GPT/Agno æ•´åˆã€è³‡æ–™åº«ã€æ–°èã€å„²å­˜
â”‚   â”œâ”€â”€ database/               # æ¨¡æ“¬è³‡æ–™åº«èˆ‡ Repository
â”‚   â”œâ”€â”€ news/                   # æ–°èè¼‰å…¥å™¨ï¼ˆå‡æ–°èæ‹¼æ¥ä¾†æºï¼‰
â”œâ”€â”€ utils/                      # å…¬ç”¨å·¥å…·ï¼ˆæ—¥èªŒã€ç•°å¸¸è™•ç†ç­‰ï¼‰
â”œâ”€â”€ config/                     # è¨­å®šç®¡ç†èˆ‡ç’°å¢ƒè®Šæ•¸åŠ è¼‰
â”œâ”€â”€ tests/                      # å–®å…ƒèˆ‡æ•´åˆæ¸¬è©¦
â””â”€â”€ main.py                     # FastAPI app å…¥å£
```

ğŸ“š éŠæˆ²æµç¨‹æ¦‚è¦½

å‡è¨Šæ¯æ–¹ï¼ˆAI Agentï¼‰ç™¼å¸ƒè¨Šæ¯ï¼ˆçœŸ/å‡ï¼‰ã€‚

ç©å®¶ç²å¾—è¨Šæ¯ï¼Œåˆ¤æ–·èˆ‡ä½¿ç”¨å·¥å…·æŸ¥æ ¸ã€‚

ç©å®¶å¯é¸æ“‡æŸ¥æ ¸ã€æ¾„æ¸…ã€é™„å’Œæˆ–å¿½ç•¥ã€‚

Game Master Agent æ¨¡æ“¬ç¾¤çœ¾åæ‡‰ä¸¦è©•åˆ†ã€‚

é›™æ–¹å›åˆäº¤æ›¿ï¼Œç›´åˆ°éŠæˆ²çµæŸã€‚

ğŸ”Œ ä¸»è¦ä¾è³´èˆ‡æ¡†æ¶

æŠ€è¡“ | ç”¨é€”
-----|-----
FastAPI | Web æ¡†æ¶ / REST API
Agno | Agent è¡Œç‚ºå»ºæ¨¡èˆ‡æ¨ç†
OpenAI API | GPT æ¨¡å‹ï¼ˆç”Ÿæˆæ–°èã€æ¾„æ¸…ã€åˆ¤å®šï¼‰
PostgreSQL | å„²å­˜éŠæˆ²ç‹€æ…‹èˆ‡è³‡æ–™
Uvicorn | éåŒæ­¥æ‡‰ç”¨ä¼ºæœå™¨
Pydantic | è³‡æ–™çµæ§‹é©—è­‰èˆ‡è½‰æ›

ğŸ§° å¥—ä»¶å®‰è£èˆ‡ç’°å¢ƒè¨­ç½®ï¼ˆä½¿ç”¨ uvï¼‰

```bash
# å®‰è£ uv
pip install uv

# å»ºç«‹è™›æ“¬ç’°å¢ƒä¸¦å®‰è£ä¾è³´
uv venv
uv pip install -r requirements.txt(uv sync)
```

å¦‚ä½¿ç”¨ uv è¨­å®šä¾è³´ï¼š

```bash
uv add (é€™å€‹æœƒè‡ªå‹•å°‡å¥—ä»¶æ›´æ–°åˆ°.lockä»¥åŠ.toml)
```

ğŸš€ å•Ÿå‹•æ–¹å¼

```bash
uvicorn main:app --reload
```

å‰å¾€ï¼šhttp://localhost:8000/docs æŸ¥çœ‹ Swagger æ–‡ä»¶ã€‚

âš™ï¸ è¨­å®šç®¡ç†

æœ¬å°ˆæ¡ˆä½¿ç”¨çµ±ä¸€çš„è¨­å®šé¡ä¾†ç®¡ç†æ‰€æœ‰æ‡‰ç”¨ç¨‹åºé…ç½®ï¼Œæ”¯æ´å¾ç’°å¢ƒè®Šæ•¸åŠ è¼‰è¨­å®šä¸¦æä¾›åˆç†çš„é è¨­å€¼ã€‚

### è¨­å®šé¡ä½¿ç”¨ç¤ºä¾‹

```python
from src.config import settings

# ä½¿ç”¨æ‡‰ç”¨è¨­å®š
port = settings.app_port
env = settings.app_env

# æª¢æŸ¥ç’°å¢ƒ
if settings.is_development:
    # é–‹ç™¼ç’°å¢ƒç‰¹å®šä»£ç¢¼
    print("Running in development mode")

# ä½¿ç”¨ API å¯†é‘°
openai_key = settings.openai_api_key
google_key = settings.google_api_key
```

ğŸ”„ çµ±ä¸€éŒ¯èª¤è™•ç†

å°ˆæ¡ˆå¯¦ä½œäº†ä¸€å€‹çµ±ä¸€çš„ç•°å¸¸è™•ç†æ©Ÿåˆ¶ï¼Œå°‡å„ç¨®ç•°å¸¸è½‰æ›ç‚ºæ¨™æº–æ ¼å¼çš„ API éŸ¿æ‡‰ï¼š

```json
{
  "success": false,
  "error": {
    "code": "RESOURCE_NOT_FOUND",
    "message": "The requested item was not found",
    "details": {
      "resource_type": "game",
      "resource_id": "123"
    }
  }
}
```

### ç•°å¸¸ä½¿ç”¨ç¤ºä¾‹

```python
# API å±¤
from src.api.middleware.error_handler import BadRequestError

@router.get("/items/{item_id}")
async def get_item(item_id: int):
    if item_id <= 0:
        raise BadRequestError(
            message="Item ID must be positive",
            error_code="INVALID_ITEM_ID"
        )
    # ...

# é ˜åŸŸå±¤
from src.utils.exceptions import ValidationError

def validate_game_action(action):
    if not action.is_valid():
        raise ValidationError(
            message="Invalid game action",
            error_code="INVALID_ACTION"
        )
    # ...
```

ğŸ¤– Agno Agent æ•´åˆèªªæ˜

Agno æœƒä½œç‚ºä¸‹åˆ—è§’è‰²åŸ·è¡Œï¼š

FakeNewsAgentï¼šæ¥æ”¶æ–°èä¾†æºï¼Œç”Ÿæˆåé —æˆ–æ‹¼è²¼å¼è¨Šæ¯ã€‚

GameMasterAgentï¼šæ ¹æ“šç©å®¶èˆ‡ AI çš„è¡Œç‚ºæ¨¡æ“¬ç¤¾ç¾¤åæ‡‰ï¼Œçµ¦å‡ºè§¸åŠç‡èˆ‡ä¿¡ä»»åˆ†æ•¸ã€‚

ClarifierAgentï¼šå”åŠ©ç©å®¶æ’°å¯«æ¾„æ¸…å…§å®¹ã€‚

æ¯å€‹ Agent çš„ prompt èˆ‡åˆå§‹åŒ–é‚è¼¯æ”¾æ–¼ï¼šinfrastructure/agents/ï¼Œä¸¦ç”± AgentFactory æ ¹æ“š DB è¨­å®šé€²è¡Œå»ºæ§‹ã€‚

Agno Docs: https://docs.agno.com/introduction

ğŸ“¡ API ç¯„ä¾‹èªªæ˜ï¼šä½¿ç”¨å·¥å…·ï¼ˆUse Toolï¼‰

æ­¤ç¯„ä¾‹å±•ç¤ºä¸€æ¢å¾ API åˆ° Infrastructure çš„å®Œæ•´æµç¨‹ï¼Œç¬¦åˆ Clean Architecture è¨­è¨ˆã€‚

ğŸ§ª åŠŸèƒ½ï¼šç©å®¶ä½¿ç”¨å·¥å…·ï¼ˆå¦‚ Podcast é »é“ï¼‰ä»¥æå‡ä¿¡ä»»åº¦

1. API Layer (/api/routes/tools.py)

```python
@router.post("/tools/use")
def use_tool(request: UseToolRequest):
    return use_tool_service(request)
```

è·è²¬ï¼šæ¥æ”¶ HTTP è«‹æ±‚ä¸¦è½‰äº¤ Use Caseã€‚

2. DTO (application/dto/use_tool_dto.py)

```python
class UseToolRequest(BaseModel):
    game_id: str
    tool_name: str

class UseToolResponse(BaseModel):
    trust_score: int
    message: str
```

è·è²¬ï¼šå°è£è¼¸å…¥èˆ‡è¼¸å‡ºè³‡æ–™çµæ§‹ï¼Œæä¾›æ‡‰ç”¨å±¤ä½¿ç”¨ã€‚

3. Application Service (application/services/use_tool.py)

```python
from domain.logic.tool_effect import apply_tool_effect
from infrastructure.repositories.game_repo import GameRepository

def use_tool_service(request: UseToolRequest) -> UseToolResponse:
    game = GameRepository.get(request.game_id)
    updated_game = apply_tool_effect(game, request.tool_name)
    GameRepository.save(updated_game)
    return UseToolResponse(trust_score=updated_game.trust_score, message=f"Used {request.tool_name}.")
```

è·è²¬ï¼šè™•ç†æµç¨‹é‚è¼¯ã€å‘¼å«æ ¸å¿ƒé‚è¼¯ä¸¦èˆ‡ Repository æºé€šã€‚

4. Domain Layer - Model (domain/models/game.py)

```python
@dataclass
class GameState:
    id: str
    trust_score: int
    tools_used: List[Tool]
```

è·è²¬ï¼šæè¿°éŠæˆ²ç‹€æ…‹çš„è³‡æ–™æ¨¡å‹ã€‚

5. Domain Layer - Logic (domain/logic/tool_effect.py)

```python
TOOL_EFFECTS = {"Podcast": 5, "AdBoost": 3}

def apply_tool_effect(game: GameState, tool_name: str) -> GameState:
    delta = TOOL_EFFECTS.get(tool_name, 0)
    game.trust_score += delta
    return game
```

è·è²¬ï¼šå®šç¾©ã€Œå·¥å…·ä½¿ç”¨å¾Œçš„é‚è¼¯è¡Œç‚ºã€ã€‚

6. Infrastructure Layer - Repository (infrastructure/repositories/game_repo.py)

```python
class GameRepository:
    @staticmethod
    def get(game_id: str) -> GameState:
        ...

    @staticmethod
    def save(game: GameState) -> None:
        ...
```

è·è²¬ï¼šèˆ‡è³‡æ–™ä¾†æºæºé€šï¼ˆDB æˆ– in-memoryï¼‰ï¼Œæä¾› Domain ä½¿ç”¨ã€‚
